{"version":3,"file":"mapHlsToHam.js","sourceRoot":"","sources":["../../../../../../src/cmaf/ham/mapper/hls/mapHlsToHam/mapHlsToHam.ts"],"names":[],"mappings":"AAKA,OAAO,EAAE,0BAA0B,EAAE,MAAM,iCAAiC,CAAC;AAC7E,OAAO,EAAE,6BAA6B,EAAE,MAAM,oCAAoC,CAAC;AACnF,OAAO,EAAE,6BAA6B,EAAE,MAAM,oCAAoC,CAAC;AAEnF,OAAO,EAAE,gBAAgB,EAAE,MAAM,wCAAwC,CAAC;AAC1E,OAAO,EAAE,gBAAgB,EAAE,MAAM,6CAA6C,CAAC;AAE/E,MAAM,UAAU,WAAW,CAAC,QAAkB;;IAC7C,MAAM,kBAAkB,GAAG,gBAAgB,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;IAC/D,MAAM,WAAW,GAAG,gBAAgB,CAAC,QAAQ,EAAE,kBAAkB,CAAC,CAAC;IACnE,MAAM,aAAa,GAAmB,EAAE,CAAC;IACzC,MAAM,iBAAiB,GAAG,WAAW,CAAC,kBAAkB;QACvD,CAAC,CAAC,CAAC,GAAG,WAAW,CAAC,kBAAkB,CAAC;QACrC,CAAC,CAAC,EAAE,CAAC;IAEN,MAAM,kBAAkB,GAAG,0BAA0B,CACpD,MAAA,kBAAkB,CAAC,WAAW,0CAAE,KAAK,EACrC,iBAAiB,CACjB,CAAC;IACF,MAAM,qBAAqB,GAAG,6BAA6B,CAC1D,MAAA,kBAAkB,CAAC,WAAW,0CAAE,SAAS,EACzC,iBAAiB,CACjB,CAAC;IACF,MAAM,kBAAkB,GAAG,6BAA6B,CACvD,kBAAkB,CAAC,SAAS,EAC5B,iBAAiB,CACjB,CAAC;IAEF,IAAI,cAAc,GAAG,CAAC,CAAC;IAEvB,IAAI,kBAAkB,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;QACnC,aAAa,CAAC,IAAI,CAAC;YAClB,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC,QAAQ,EAAE;YACjC,aAAa,EAAE,kBAAkB;SACjB,CAAC,CAAC;IACpB,CAAC;IAED,IAAI,qBAAqB,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;QACtC,aAAa,CAAC,IAAI,CAAC;YAClB,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC,QAAQ,EAAE;YACjC,aAAa,EAAE,qBAAqB;SACpB,CAAC,CAAC;IACpB,CAAC;IAED,IAAI,kBAAkB,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;QACnC,aAAa,CAAC,IAAI,CAAC;YAClB,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC,QAAQ,EAAE;YACjC,aAAa,EAAE,kBAAkB;SACjB,CAAC,CAAC;IACpB,CAAC;IAED,IAAI,cAAc,GAAG,CAAC,CAAC;IAEvB,OAAO;QACN,EAAE,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC,QAAQ,EAAE,EAAE,aAAa,EAAE,aAAa,EAAE;KACnE,CAAC;AACH,CAAC","sourcesContent":["import type { Presentation } from '../../../types/model/Presentation.js';\nimport type { SelectionSet } from '../../../types/model/SelectionSet.js';\n\nimport type { Manifest } from '../../../types/manifest/Manifest.js';\n\nimport { audioGroupsToSwitchingSets } from './audioGroupsToSwitchingSets.js';\nimport { subtitleGroupsToSwitchingSets } from './subtitleGroupsToSwitchingSets.js';\nimport { videoPlaylistsToSwitchingSets } from './videoPlaylistsToSwitchingSets.js';\n\nimport { parseHlsManifest } from '../../../utils/hls/parseHlsManifest.js';\nimport { addMetadataToHls } from '../../../utils/manifest/addMetadataToHls.js';\n\nexport function mapHlsToHam(manifest: Manifest): Presentation[] {\n\tconst mainManifestParsed = parseHlsManifest(manifest.manifest);\n\tconst manifestHls = addMetadataToHls(manifest, mainManifestParsed);\n\tconst selectionSets: SelectionSet[] = [];\n\tconst manifestPlaylists = manifestHls.ancillaryManifests\n\t\t? [...manifestHls.ancillaryManifests]\n\t\t: [];\n\n\tconst audioSwitchingSets = audioGroupsToSwitchingSets(\n\t\tmainManifestParsed.mediaGroups?.AUDIO,\n\t\tmanifestPlaylists,\n\t);\n\tconst subtitleSwitchingSets = subtitleGroupsToSwitchingSets(\n\t\tmainManifestParsed.mediaGroups?.SUBTITLES,\n\t\tmanifestPlaylists,\n\t);\n\tconst videoSwitchingSets = videoPlaylistsToSwitchingSets(\n\t\tmainManifestParsed.playlists,\n\t\tmanifestPlaylists,\n\t);\n\n\tlet selectionSetId = 0;\n\n\tif (audioSwitchingSets.length > 0) {\n\t\tselectionSets.push({\n\t\t\tid: (selectionSetId++).toString(),\n\t\t\tswitchingSets: audioSwitchingSets,\n\t\t} as SelectionSet);\n\t}\n\n\tif (subtitleSwitchingSets.length > 0) {\n\t\tselectionSets.push({\n\t\t\tid: (selectionSetId++).toString(),\n\t\t\tswitchingSets: subtitleSwitchingSets,\n\t\t} as SelectionSet);\n\t}\n\n\tif (videoSwitchingSets.length > 0) {\n\t\tselectionSets.push({\n\t\t\tid: (selectionSetId++).toString(),\n\t\t\tswitchingSets: videoSwitchingSets,\n\t\t} as SelectionSet);\n\t}\n\n\tlet presentationId = 0;\n\n\treturn [\n\t\t{ id: (presentationId++).toString(), selectionSets: selectionSets },\n\t];\n}\n"]}