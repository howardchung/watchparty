{"version":3,"file":"ZlemaEstimator.js","sourceRoot":"","sources":["../../../src/throughput/ZlemaEstimator.ts"],"names":[],"mappings":";;;AACA,oEAA8D;AAG9D;;;;;;GAMG;AACH,MAAa,cAAc;IAA3B;QACS,YAAO,GAAqB,EAAE,CAAC;IAwBxC,CAAC;IAtBO,MAAM,CAAC,MAAsB;QACnC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC3B,CAAC;IAEM,WAAW;QACjB,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YAC/B,OAAO,GAAG,CAAC;QACZ,CAAC;QAED,MAAM,KAAK,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAE5C,IAAI,GAAW,EAAE,KAAa,CAAC;QAE/B,GAAG,GAAG,KAAK,GAAG,IAAA,oCAAe,EAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;QAErE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAC9C,GAAG,GAAG,KAAK,GAAG,IAAA,oCAAe,EAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,GAAG,GAAG,CAAC;YACnE,KAAK,GAAG,KAAK,GAAG,GAAG,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC;QAC3C,CAAC;QAED,OAAO,KAAK,CAAC;IACd,CAAC;CACD;AAzBD,wCAyBC","sourcesContent":["import type { ResourceTiming } from '../request/ResourceTiming.js';\nimport { getBandwidthBps } from '../utils/getBandwidthBps.js';\nimport type { ThroughputEstimator } from './ThroughputEstimator.js';\n\n/**\n * Zero-Lag Exponential Moving Average (ZLEMA) throughput estimator\n *\n * @group Throughput\n *\n * @beta\n */\nexport class ZlemaEstimator implements ThroughputEstimator {\n\tprivate samples: ResourceTiming[] = [];\n\n\tpublic sample(sample: ResourceTiming): void {\n\t\tthis.samples.push(sample);\n\t}\n\n\tpublic getEstimate(): number {\n\t\tif (this.samples.length === 0) {\n\t\t\treturn NaN;\n\t\t}\n\n\t\tconst alpha = 2 / (this.samples.length + 1);\n\n\t\tlet ema: number, zlema: number;\n\n\t\tema = zlema = getBandwidthBps(this.samples[this.samples.length - 1]);\n\n\t\tfor (let i = 0; i < this.samples.length; i++) {\n\t\t\tema = alpha * getBandwidthBps(this.samples[i]) + (1 - alpha) * ema;\n\t\t\tzlema = alpha * ema + (1 - alpha) * zlema;\n\t\t}\n\n\t\treturn zlema;\n\t}\n}\n"]}