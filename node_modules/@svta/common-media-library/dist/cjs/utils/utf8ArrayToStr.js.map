{"version":3,"file":"utf8ArrayToStr.js","sourceRoot":"","sources":["../../../src/utils/utf8ArrayToStr.ts"],"names":[],"mappings":";AAAA,yFAAyF;AACzF,iEAAiE;AACjE;;;;;;GAMG;;AAaH,wCA+DC;AA1ED;;;;;;;;;;GAUG;AACH,SAAgB,cAAc,CAC7B,KAAiB,EACjB,aAAsB,KAAK;IAE3B,IAAI,OAAO,WAAW,KAAK,WAAW,EAAE,CAAC;QACxC,MAAM,OAAO,GAAG,IAAI,WAAW,CAAC,OAAO,CAAC,CAAC;QACzC,MAAM,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAEtC,IAAI,UAAU,EAAE,CAAC;YAChB,4BAA4B;YAC5B,MAAM,GAAG,GAAG,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YAClC,OAAO,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;QACzD,CAAC;QAED,6BAA6B;QAC7B,OAAO,OAAO,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;IACnC,CAAC;IAED,MAAM,GAAG,GAAG,KAAK,CAAC,MAAM,CAAC;IACzB,IAAI,CAAC,CAAC;IACN,IAAI,KAAK,CAAC;IACV,IAAI,KAAK,CAAC;IACV,IAAI,GAAG,GAAG,EAAE,CAAC;IACb,IAAI,CAAC,GAAG,CAAC,CAAC;IACV,OAAO,CAAC,GAAG,GAAG,EAAE,CAAC;QAChB,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;QACf,IAAI,CAAC,KAAK,IAAI,IAAI,UAAU,EAAE,CAAC;YAC9B,OAAO,GAAG,CAAC;QACZ,CAAC;aACI,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC;YACnC,+DAA+D;YAC/D,SAAS;QACV,CAAC;QACD,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC;YAChB,KAAK,CAAC,CAAC;YACP,KAAK,CAAC,CAAC;YACP,KAAK,CAAC,CAAC;YACP,KAAK,CAAC,CAAC;YACP,KAAK,CAAC,CAAC;YACP,KAAK,CAAC,CAAC;YACP,KAAK,CAAC,CAAC;YACP,KAAK,CAAC;gBACL,WAAW;gBACX,GAAG,IAAI,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;gBAC9B,MAAM;YACP,KAAK,EAAE,CAAC;YACR,KAAK,EAAE;gBACN,wBAAwB;gBACxB,KAAK,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;gBACnB,GAAG,IAAI,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC;gBAC/D,MAAM;YACP,KAAK,EAAE;gBACN,kCAAkC;gBAClC,KAAK,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;gBACnB,KAAK,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;gBACnB,GAAG,IAAI,MAAM,CAAC,YAAY,CACzB,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAClE,CAAC;gBACF,MAAM;YACP,QAAQ;QACT,CAAC;IACF,CAAC;IACD,OAAO,GAAG,CAAC;AACZ,CAAC","sourcesContent":["// http://stackoverflow.com/questions/8936984/uint8array-to-string-in-javascript/22373197\n// http://www.onicos.com/staff/iz/amuse/javascript/expert/utf.txt\n/* utf.js - UTF-8 <=> UTF-16 convertion\n *\n * Copyright (C) 1999 Masanao Izumo <iz@onicos.co.jp>\n * Version: 1.0\n * LastModified: Dec 25 1999\n * This library is free.  You can redistribute it and/or modify it.\n */\n\n/**\n * Converts a UTF-8 array to a string.\n *\n * @param array - The UTF-8 array to convert\n *\n * @returns The string\n *\n * @group Utils\n *\n * @beta\n */\nexport function utf8ArrayToStr(\n\tarray: Uint8Array,\n\texitOnNull: boolean = false,\n): string {\n\tif (typeof TextDecoder !== 'undefined') {\n\t\tconst decoder = new TextDecoder('utf-8');\n\t\tconst decoded = decoder.decode(array);\n\n\t\tif (exitOnNull) {\n\t\t\t// grab up to the first null\n\t\t\tconst idx = decoded.indexOf('\\0');\n\t\t\treturn idx !== -1 ? decoded.substring(0, idx) : decoded;\n\t\t}\n\n\t\t// remove any null characters\n\t\treturn decoded.replace(/\\0/g, '');\n\t}\n\n\tconst len = array.length;\n\tlet c;\n\tlet char2;\n\tlet char3;\n\tlet out = '';\n\tlet i = 0;\n\twhile (i < len) {\n\t\tc = array[i++];\n\t\tif (c === 0x00 && exitOnNull) {\n\t\t\treturn out;\n\t\t}\n\t\telse if (c === 0x00 || c === 0x03) {\n\t\t\t// If the character is 3 (END_OF_TEXT) or 0 (NULL) then skip it\n\t\t\tcontinue;\n\t\t}\n\t\tswitch (c >> 4) {\n\t\t\tcase 0:\n\t\t\tcase 1:\n\t\t\tcase 2:\n\t\t\tcase 3:\n\t\t\tcase 4:\n\t\t\tcase 5:\n\t\t\tcase 6:\n\t\t\tcase 7:\n\t\t\t\t// 0xxxxxxx\n\t\t\t\tout += String.fromCharCode(c);\n\t\t\t\tbreak;\n\t\t\tcase 12:\n\t\t\tcase 13:\n\t\t\t\t// 110x xxxx   10xx xxxx\n\t\t\t\tchar2 = array[i++];\n\t\t\t\tout += String.fromCharCode(((c & 0x1f) << 6) | (char2 & 0x3f));\n\t\t\t\tbreak;\n\t\t\tcase 14:\n\t\t\t\t// 1110 xxxx  10xx xxxx  10xx xxxx\n\t\t\t\tchar2 = array[i++];\n\t\t\t\tchar3 = array[i++];\n\t\t\t\tout += String.fromCharCode(\n\t\t\t\t\t((c & 0x0f) << 12) | ((char2 & 0x3f) << 6) | ((char3 & 0x3f) << 0),\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t}\n\treturn out;\n}\n"]}